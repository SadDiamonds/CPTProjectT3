{% extends "layout.html" %}

{% block title %}All Donations{% endblock %}

{% block content %}
<div id="swup" class="transition-fade">
<main class="donations-page">
  <h1>All Donations</h1>

  <form method="get" action="{{ url_for('donations_page') }}" class="filter-form-modern">
    <!-- Search input -->
    <div class="filter-input-wrapper">
      <input 
        type="text" 
        name="q" 
        placeholder="Search donations..." 
        value="{{ search or '' }}" 
        class="filter-input"
      >
    </div>

    <!-- Category select -->
    <div class="filter-select-wrapper">
      <select name="category" class="filter-select">
        <option value="">All Categories</option>
        {% for c in categories %}
          <option value="{{ c }}" {% if c == category %}selected{% endif %}>{{ c }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- Apply button -->
    <button type="submit" class="filter-btn">Apply</button>
  </form>



  <!-- Donations grid -->
  {% if donations %}
    <div class="donations-grid">
      {% for donation in donations %}
        <div class="donation-card">
          <img src="{{ url_for('static', filename=donation.image_url) if donation.image_url else url_for('static', filename='Images/placeholder.png') }}" class="donation-image">
          <h3 class="donation-title">{{ donation.items }}</h3>
          <p class="donation-category">{{ donation.category }}</p>
          <p class="donation-date"><small>Donated on {{ donation.date_donated }}</small></p>

          {% if user and user['role'] == "Recipient" %}
            <form action="{{ url_for('claim_donation', donation_id=donation.donation_id) }}" method="POST">
              <button type="submit" class="claim-btn">Claim</button>
            </form>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="no-donations">No donations found.</p>
  {% endif %}

</main>
</div>
{% endblock %}
